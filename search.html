<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MT Search</title>
</head>

<body>
    <p id="big-text">Loading...</p>
    <hr>
    <div id="text"></div>
    <script>
        var query = decodeURIComponent(window.location.search.substring(1).split("q=")[1].trim()).split(" ");
        const books = [
            [
                "GEN",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36,
                    37,
                    38,
                    39,
                    40,
                    41,
                    42,
                    43,
                    44,
                    45,
                    46,
                    47,
                    48,
                    49,
                    50
                ]
            ],
            [
                "EXO",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36,
                    37,
                    38,
                    39,
                    40
                ]
            ],
            [
                "LEV",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27
                ]
            ],
            [
                "NUM",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36
                ]
            ],
            [
                "DEU",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34
                ]
            ],
            [
                "JOS",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24
                ]
            ],
            [
                "JDG",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21
                ]
            ],
            [
                "RUT",
                [
                    1, 2, 3, 4
                ]
            ],
            [
                "1SA",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31
                ]
            ],
            [
                "2SA",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24
                ]
            ],
            [
                "1KI",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22
                ]
            ],
            [
                "2KI",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25
                ]
            ],
            [
                "1CH",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29
                ]
            ],
            [
                "2CH",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36
                ]
            ],
            [
                "EZR",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10
                ]
            ],
            [
                "NEH",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13
                ]
            ],
            [
                "EST",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10
                ]
            ],
            [
                "JOB",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36,
                    37,
                    38,
                    39,
                    40,
                    41,
                    42
                ]
            ],
            [
                "PSA",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36,
                    37,
                    38,
                    39,
                    40,
                    41,
                    42,
                    43,
                    44,
                    45,
                    46,
                    47,
                    48,
                    49,
                    50,
                    51,
                    52,
                    53,
                    54,
                    55,
                    56,
                    57,
                    58,
                    59,
                    60,
                    61,
                    62,
                    63,
                    64,
                    65,
                    66,
                    67,
                    68,
                    69,
                    70,
                    71,
                    72,
                    73,
                    74,
                    75,
                    76,
                    77,
                    78,
                    79,
                    80,
                    81,
                    82,
                    83,
                    84,
                    85,
                    86,
                    87,
                    88,
                    89,
                    90,
                    91,
                    92,
                    93,
                    94,
                    95,
                    96,
                    97,
                    98,
                    99,
                    100,
                    101,
                    102,
                    103,
                    104,
                    105,
                    106,
                    107,
                    108,
                    109,
                    110,
                    111,
                    112,
                    113,
                    114,
                    115,
                    116,
                    117,
                    118,
                    119,
                    120,
                    121,
                    122,
                    123,
                    124,
                    125,
                    126,
                    127,
                    128,
                    129,
                    130,
                    131,
                    132,
                    133,
                    134,
                    135,
                    136,
                    137,
                    138,
                    139,
                    140,
                    141,
                    142,
                    143,
                    144,
                    145,
                    146,
                    147,
                    148,
                    149,
                    150
                ]
            ],
            [
                "PRO",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31
                ]
            ],
            [
                "ECC",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12
                ]
            ],
            [
                "SNG",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8
                ]
            ],
            [
                "ISA",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36,
                    37,
                    38,
                    39,
                    40,
                    41,
                    42,
                    43,
                    44,
                    45,
                    46,
                    47,
                    48,
                    49,
                    50,
                    51,
                    52,
                    53,
                    54,
                    55,
                    56,
                    57,
                    58,
                    59,
                    60,
                    61,
                    62,
                    63,
                    64,
                    65,
                    66
                ]
            ],
            [
                "JER",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36,
                    37,
                    38,
                    39,
                    40,
                    41,
                    42,
                    43,
                    44,
                    45,
                    46,
                    47,
                    48,
                    49,
                    50,
                    51,
                    52
                ]
            ],
            [
                "LAM",
                [
                    1,
                    2,
                    3,
                    4,
                    5
                ]
            ],
            [
                "EZK",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28,
                    29,
                    30,
                    31,
                    32,
                    33,
                    34,
                    35,
                    36,
                    37,
                    38,
                    39,
                    40,
                    41,
                    42,
                    43,
                    44,
                    45,
                    46,
                    47,
                    48
                ]
            ],
            [
                "DAN",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12
                ]
            ],
            [
                "HOS",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14
                ]
            ],
            [
                "JOL",
                [
                    1, 2, 3
                ]
            ],
            [
                "AMO",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9
                ]
            ],
            [
                "OBA", [1]
            ],
            [
                "JON",
                [
                    1, 2, 3, 4
                ]
            ],
            [
                "MIC",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7
                ]
            ],
            [
                "NAM",
                [
                    1, 2, 3
                ]
            ],
            [
                "HAB",
                [
                    1, 2, 3
                ]
            ],
            [
                "ZEP",
                [
                    1, 2, 3
                ]
            ],
            [
                "HAG",
                [
                    1, 2
                ]
            ],
            [
                "ZEC",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14
                ]
            ],
            [
                "MAL",
                [
                    1, 2, 3, 4
                ]
            ]/*,
            [
                "MAT",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28
                ]
            ],
            [
                "MAR",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16
                ]
            ],
            [
                "LUK",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24
                ]
            ],
            [
                "JOH",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21
                ]
            ],
            [
                "ACT",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28
                ]
            ],
            [
                "ROM",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16
                ]
            ],
            [
                "1CO",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16
                ]
            ],
            [
                "2CO",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13
                ]
            ],
            [
                "GAL",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6
                ]
            ],
            [
                "EPH",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6
                ]
            ],
            [
                "PHP",
                [
                    1,
                    2,
                    3,
                    4
                ]
            ],
            [
                "COL",
                [
                    1,
                    2,
                    3,
                    4
                ]
            ],
            [
                "1TH",
                [
                    1,
                    2,
                    3,
                    4,
                    5
                ]
            ],
            [
                "2TH",
                [
                    1,
                    2,
                    3
                ]
            ],
            [
                "1TI",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6
                ]
            ],
            [
                "2TI",
                [
                    1,
                    2,
                    3
                ]
            ],
            [
                "PHM",
                [
                    1
                ]
            ],
            [
                "HEB",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13
                ]
            ],
            [
                "JAS",
                [
                    1,
                    2,
                    3
                ]
            ],
            [
                "1PE",
                [
                    1,
                    2,
                    3,
                    4,
                    5
                ]
            ],
            [
                "2PE",
                [
                    1,
                    2,
                    3
                ]
            ],
            [
                "1JN",
                [
                    1,
                    2,
                    3,
                    4,
                    5
                ]
            ],
            [
                "2JN",
                [
                    1
                ]
            ],
            [
                "3JN",
                [
                    1
                ]
            ],
            [
                "JUD",
                [
                    1
                ]
            ],
            [
                "REV",
                [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    13,
                    14,
                    15,
                    16,
                    17,
                    18,
                    19,
                    20,
                    21,
                    22,
                    23,
                    24,
                    25,
                    26,
                    27,
                    28
                ]
            ]*/
        ];
        const bookOrder = {
            GEN: 1,
            EXO: 2,
            LEV: 3,
            NUM: 4,
            DEU: 5,
            JOS: 6,
            JDG: 7,
            RUT: 8,
            '1SA': 9,
            '2SA': 10,
            '1KI': 11,
            '2KI': 12,
            '1CH': 13,
            '2CH': 14,
            EZR: 15,
            NEH: 16,
            EST: 17,
            JOB: 18,
            PSA: 19,
            PRO: 20,
            ECC: 21,
            'SNG': 22,
            ISA: 23,
            JER: 24,
            LAM: 25,
            EZK: 26,
            DAN: 27,
            HOS: 28,
            JOE: 29,
            AMO: 30,
            OBA: 31,
            JON: 32,
            MIC: 33,
            NAH: 34,
            HAB: 35,
            ZEP: 36,
            HAG: 37,
            ZEC: 38,
            MAL: 39
        };

        function compareVerses(verse1, verse2) {
            const [, book1, chapter1, verseNum1] = verse1.match(/(\w+) (\d+):(\d+)/);
            const [, book2, chapter2, verseNum2] = verse2.match(/(\w+) (\d+):(\d+)/);

            const bookOrder1 = bookOrder[book1];
            const bookOrder2 = bookOrder[book2];

            if (bookOrder1 !== bookOrder2)
                return bookOrder1 - bookOrder2;


            if (parseInt(chapter1) !== parseInt(chapter2))
                return parseInt(chapter1) - parseInt(chapter2);


            return parseInt(verseNum1) - parseInt(verseNum2);
        }

        async function getResource(q) {
            var verses = [];
            await Promise.all(books.map(async (book) => {
                await Promise.all(book[1].map(async (chapter, ii) => {
                    var data = await fetch(`./Bible/${book[0]}/${ii + 1}.json`);
                    data = await data.json();
                    await Promise.all(data.verses.map(async (verse) => {
                        let num = 0;
                        q.forEach((qq) => {
                            let isWildcard = qq.endsWith('*');
                            let searchTerm = isWildcard ? qq.slice(0, -1) : qq;

                            // Create a regex pattern for inclusive search if it's a wildcard
                            let regex = isWildcard ? new RegExp(`\\b${searchTerm}\\w*`, 'g') : new RegExp(`\\b${searchTerm}\\b`, 'g');

                            if (verse.text.match(regex)) {
                                verse.text = verse.text.split(" ").map(word => {
                                    if (isWildcard && word.startsWith(searchTerm)) {
                                        return `<b>${word}</b>`;
                                    } else if (!isWildcard && word === searchTerm) {
                                        return `<b>${word}</b>`;
                                    }
                                    return word;
                                }).join(" ");

                                // Highlight all occurrences of the search term in the verse text
                                verse.text = verse.text.replace(regex, match => `<b>${match}</b>`);
                                num++;
                            }
                        });
                        if (num === q.length) {
                            verses.push(`${verse.book_name} ${ii + 1}:${verse.verse} - ${verse.text}<br>`);
                        }
                    }));
                }));
            }));

            const sortedVerses = verses.sort(compareVerses);
            document.getElementById("text").innerHTML = sortedVerses.join("");
            document.getElementById("big-text").innerHTML = `Found ${verses.length} Verses Containing <b>${q.join(", ")}</b>`;
        }

        getResource(query);
    </script>
</body>

</html>